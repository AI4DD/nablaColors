2025-08-21 21:00:19,627 INFO    MainThread:3490898 [wandb_setup.py:_flush():80] Current SDK version is 0.21.1
2025-08-21 21:00:19,627 INFO    MainThread:3490898 [wandb_setup.py:_flush():80] Configure stats pid to 3490898
2025-08-21 21:00:19,627 INFO    MainThread:3490898 [wandb_setup.py:_flush():80] Loading settings from /home/potapov/.config/wandb/settings
2025-08-21 21:00:19,627 INFO    MainThread:3490898 [wandb_setup.py:_flush():80] Loading settings from /mnt/5tb/potapov/nablaColors/unimol_plus/wandb/settings
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_setup.py:_flush():80] Loading settings from environment variables
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_init.py:setup_run_log_directory():703] Logging user logs to /mnt/5tb/potapov/nablaColors/unimol_plus/wandb/offline-run-20250821_210019-finetune_all_expsingletarget_runbs_2_head_pretrain/logs/debug.log
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_init.py:setup_run_log_directory():704] Logging internal logs to /mnt/5tb/potapov/nablaColors/unimol_plus/wandb/offline-run-20250821_210019-finetune_all_expsingletarget_runbs_2_head_pretrain/logs/debug-internal.log
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_init.py:init():830] calling init triggers
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_init.py:init():835] wandb.init called with sweep_config: {}
config: {'no_progress_bar': False, 'log_interval': 100, 'log_format': 'simple', 'tensorboard_logdir': '../results/checkpoints_unimol/exp_singletarget/run_bs_2_head_pretrain-ema0.999/tsb', 'wandb_project': 'UniMol', 'wandb_name': 'finetune_all_expsingletarget_runbs_2_head_pretrain', 'seed': 1, 'cpu': False, 'fp16': False, 'bf16': False, 'bf16_sr': False, 'allreduce_fp32_grad': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 4, 'fp16_scale_window': 256, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': './unimol_plus', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'suppress_crashes': False, 'profile': False, 'ema_decay': 0.999, 'validate_with_ema': True, 'head_pretrain': True, 'loss': 'unimol_plus', 'optimizer': 'adam', 'lr_scheduler': 'polynomial_decay', 'task': 'pcq', 'num_workers': 4, 'skip_invalid_size_inputs_valid_test': False, 'batch_size': 2, 'required_batch_size_multiple': 1, 'data_buffer_size': 32, 'train_subset': 'train', 'valid_subset': 'valid', 'validate_interval': 5, 'validate_interval_updates': 500, 'validate_after_updates': 0, 'fixed_validation_seed': 11, 'disable_validation': False, 'batch_size_valid': 2, 'max_valid_steps': None, 'curriculum': 0, 'distributed_world_size': 2, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'broadcast_buffers': False, 'nprocs_per_node': 2, 'arch': 'uniprop_small', 'max_epoch': 0, 'max_update': 300000, 'stop_time_hours': 0, 'clip_norm': 5.0, 'per_sample_clip_norm': 0, 'update_freq': [1], 'lr': [8e-05], 'stop_min_lr': -1, 'save_dir': '../results/checkpoints_unimol/exp_singletarget/run_bs_2_head_pretrain-ema0.999', 'tmp_save_dir': './', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': '../unimol_plus_pcq_small.pt', 'chemprop_weight_path': '../models/chemprop/fold_0/model_1/model.pt', 'load_from_ema': True, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': 50, 'keep_last_epochs': -1, 'keep_best_checkpoints': 3, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '_expsingletarget_runbs_2_head_pretrain', 'droppath_prob': 0.0, 'noise_scale': 0.2, 'label_prob': 0.8, 'mid_prob': 0.1, 'mid_upper': 0.6, 'mid_lower': 0.4, 'pos_loss_weight': 0.3, 'dist_loss_weight': 1.5, 'min_pos_loss_weight': 0.06, 'min_dist_loss_weight': 0.3, 'abs_loss_weight': 1.0, 'emm_loss_weight': 1.0, 'plqy_loss_weight': 1.0, 'data': '../conformations/xtb_to_dft_implicit', 'single_target': True, 'target_index': 0, 'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'force_anneal': None, 'warmup_updates': 30000, 'warmup_ratio': -1.0, 'end_learning_rate': 1e-09, 'power': 1.0, 'total_num_update': 300000, 'no_seed_provided': False, 'layers': 6, 'embed_dim': 768, 'pair_embed_dim': 256, 'pair_hidden_dim': 32, 'attention_heads': 48, 'ffn_embed_dim': 768, 'activation_fn': 'gelu', 'pair_dropout': 0.25, 'attention_dropout': 0.1, 'act_dropout': 0.1, 'dropout': 0.0, 'num_3d_bias_kernel': 128, 'num_block': 2, 'pos_step_size': 1.0, 'gaussian_std_width': 1.0, 'gaussian_mean_start': 0.0, 'gaussian_mean_stop': 9.0, 'overwrite_default_atom_features': False, 'overwrite_default_bond_features': False, 'features_only': False, 'use_input_features': False, 'mpn_shared': False, 'number_of_molecules': 1, 'atom_messages': False, 'hidden_size': 482, 'bias': False, 'depth': 5, 'undirected': False, 'aggregation': 'mean', 'aggregation_norm': 100, 'activation': 'relu', 'atom_descriptors': '', 'atom_descriptors_size': 0, 'atom_fdim': 0, 'bond_fdim': 0, '_wandb': {}}
2025-08-21 21:00:19,628 INFO    MainThread:3490898 [wandb_init.py:init():871] starting backend
2025-08-21 21:00:19,834 INFO    MainThread:3490898 [wandb_init.py:init():874] sending inform_init request
2025-08-21 21:00:19,838 INFO    MainThread:3490898 [wandb_init.py:init():882] backend started and connected
2025-08-21 21:00:19,840 INFO    MainThread:3490898 [wandb_init.py:init():953] updated telemetry
2025-08-21 21:00:19,844 INFO    MainThread:3490898 [wandb_init.py:init():977] communicating run to backend with 90.0 second timeout
2025-08-21 21:00:19,950 INFO    MainThread:3490898 [wandb_init.py:init():1029] starting run threads in backend
2025-08-21 21:00:20,012 INFO    MainThread:3490898 [wandb_run.py:_console_start():2494] atexit reg
2025-08-21 21:00:20,012 INFO    MainThread:3490898 [wandb_run.py:_redirect():2342] redirect: wrap_raw
2025-08-21 21:00:20,013 INFO    MainThread:3490898 [wandb_run.py:_redirect():2411] Wrapping output streams.
2025-08-21 21:00:20,013 INFO    MainThread:3490898 [wandb_run.py:_redirect():2434] Redirects installed.
2025-08-21 21:00:20,014 INFO    MainThread:3490898 [wandb_init.py:init():1075] run started, returning control to user process
